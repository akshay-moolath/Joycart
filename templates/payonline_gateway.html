<button id="pay-btn">Pay Now</button>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
document.getElementById("pay-btn").onclick = async function () {

  const formData = new FormData();
  formData.append("checkout_id", "{{ checkout_id }}");

  const res = await fetch("/api/checkout/payonline/create", {
    method: "POST",
    body: formData,
    credentials: "include" 
  });

  if (!res.ok) {
    alert("Failed to initiate payment");
    return;
  }

  const data = await res.json();

  const options = {
    key: data.key,
    amount: data.amount,
    currency: data.currency,
    order_id: data.order_id,
    handler: function () {
      
      window.location.href = "/checkout/payonline/waiting";
    }
  };

  new Razorpay(options).open();
};
</script>
